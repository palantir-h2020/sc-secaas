<?xml version="1.0"?>
<opnsense>
  <theme>opnsense</theme>
  <sysctl>
    <item>
      <descr>Increase UFS read-ahead speeds to match the state of hard drives and NCQ.</descr>
      <tunable>vfs.read_max</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Set the ephemeral port range to be lower.</descr>
      <tunable>net.inet.ip.portrange.first</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Drop packets to closed TCP ports without returning a RST</descr>
      <tunable>net.inet.tcp.blackhole</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Do not send ICMP port unreachable messages for closed UDP ports</descr>
      <tunable>net.inet.udp.blackhole</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Randomize the ID field in IP packets</descr>
      <tunable>net.inet.ip.random_id</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>
        Source routing is another way for an attacker to try to reach non-routable addresses behind your box.
        It can also be used to probe for information about your internal networks. These functions come enabled
        as part of the standard FreeBSD core system.
      </descr>
      <tunable>net.inet.ip.sourceroute</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>
        Source routing is another way for an attacker to try to reach non-routable addresses behind your box.
        It can also be used to probe for information about your internal networks. These functions come enabled
        as part of the standard FreeBSD core system.
      </descr>
      <tunable>net.inet.ip.accept_sourceroute</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>
        This option turns off the logging of redirect packets because there is no limit and this could fill
        up your logs consuming your whole hard drive.
      </descr>
      <tunable>net.inet.icmp.log_redirect</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Drop SYN-FIN packets (breaks RFC1379, but nobody uses it anyway)</descr>
      <tunable>net.inet.tcp.drop_synfin</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Enable sending IPv6 redirects</descr>
      <tunable>net.inet6.ip6.redirect</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Enable privacy settings for IPv6 (RFC 4941)</descr>
      <tunable>net.inet6.ip6.use_tempaddr</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Prefer privacy addresses and use them over the normal addresses</descr>
      <tunable>net.inet6.ip6.prefer_tempaddr</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Generate SYN cookies for outbound SYN-ACK packets</descr>
      <tunable>net.inet.tcp.syncookies</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Maximum incoming/outgoing TCP datagram size (receive)</descr>
      <tunable>net.inet.tcp.recvspace</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Maximum incoming/outgoing TCP datagram size (send)</descr>
      <tunable>net.inet.tcp.sendspace</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Do not delay ACK to try and piggyback it onto a data packet</descr>
      <tunable>net.inet.tcp.delayed_ack</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Maximum outgoing UDP datagram size</descr>
      <tunable>net.inet.udp.maxdgram</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Handling of non-IP packets which are not passed to pfil (see if_bridge(4))</descr>
      <tunable>net.link.bridge.pfil_onlyip</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Set to 1 to additionally filter on the physical interface for locally destined packets</descr>
      <tunable>net.link.bridge.pfil_local_phys</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Set to 0 to disable filtering on the incoming and outgoing member interfaces.</descr>
      <tunable>net.link.bridge.pfil_member</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Set to 1 to enable filtering on the bridge interface</descr>
      <tunable>net.link.bridge.pfil_bridge</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Allow unprivileged access to tap(4) device nodes</descr>
      <tunable>net.link.tap.user_open</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Randomize PID's (see src/sys/kern/kern_fork.c: sysctl_kern_randompid())</descr>
      <tunable>kern.randompid</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Maximum size of the IP input queue</descr>
      <tunable>net.inet.ip.intr_queue_maxlen</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Disable CTRL+ALT+Delete reboot from keyboard.</descr>
      <tunable>hw.syscons.kbd_reboot</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Hint at default settings for serial console in case the autodetect is not working</descr>
      <tunable>hw.uart.console</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Enable TCP extended debugging</descr>
      <tunable>net.inet.tcp.log_debug</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Set ICMP Limits</descr>
      <tunable>net.inet.icmp.icmplim</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>TCP Offload Engine</descr>
      <tunable>net.inet.tcp.tso</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>UDP Checksums</descr>
      <tunable>net.inet.udp.checksum</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Maximum socket buffer size</descr>
      <tunable>kern.ipc.maxsockbuf</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Page Table Isolation (Meltdown mitigation, requires reboot.)</descr>
      <tunable>vm.pmap.pti</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Disable Indirect Branch Restricted Speculation (Spectre V2 mitigation)</descr>
      <tunable>hw.ibrs_disable</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Hide processes running as other groups</descr>
      <tunable>security.bsd.see_other_gids</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Hide processes running as other users</descr>
      <tunable>security.bsd.see_other_uids</tunable>
      <value>default</value>
    </item>
    <item>
      <descr>Enable/disable sending of ICMP redirects in response to IP packets for which a better,
        and for the sender directly reachable, route and next hop is known.
      </descr>
      <tunable>net.inet.ip.redirect</tunable>
      <value>0</value>
    </item>
    <item>
      <descr>
        Redirect attacks are the purposeful mass-issuing of ICMP type 5 packets. In a normal network, redirects
        to the end stations should not be required. This option enables the NIC to drop all inbound ICMP redirect
        packets without returning a response.
      </descr>
      <tunable>net.inet.icmp.drop_redirect</tunable>
      <value>1</value>
    </item>
    <item>
      <descr>Maximum outgoing UDP datagram size</descr>
      <tunable>net.local.dgram.maxdgram</tunable>
      <value>default</value>
    </item>
  </sysctl>
  <system>
    <optimization>conservative</optimization>
    <hostname>firewall</hostname>
    <domain>firewall.local</domain>
    <dnsallowoverride>on</dnsallowoverride>
    <group>
      <name>admins</name>
      <description>System Administrators</description>
      <scope>system</scope>
      <gid>1999</gid>
      <member>0</member>
      <member>2000</member>
      <member>2001</member>
      <priv>page-all</priv>
    </group>
    <user>
      <name>root</name>
      <descr>System Administrator</descr>
      <scope>system</scope>
      <groupname>admins</groupname>
      <password>$2y$10$fEVdn19AzOCcfdG5hBUWBu9.vE7QJfSBPvAdmMLqanQsEf0QCO/Ya</password>
      <uid>0</uid>
      <expires/>
      <authorizedkeys/>
      <ipsecpsk/>
      <otp_seed/>
    </user>
    <nextuid>2002</nextuid>
    <nextgid>2000</nextgid>
    <timezone>Europe/Rome</timezone>
    <timeservers>0.opnsense.pool.ntp.org 1.opnsense.pool.ntp.org 2.opnsense.pool.ntp.org 3.opnsense.pool.ntp.org</timeservers>
    <webgui>
      <protocol>https</protocol>
      <ssl-certref/>
      <port/>
      <compression/>
      <ssl-hsts/>
      <ssl-ciphers/>
      <interfaces/>
      <nodnsrebindcheck>1</nodnsrebindcheck>
    </webgui>
    <usevirtualterminal>1</usevirtualterminal>
    <disableconsolemenu>1</disableconsolemenu>
    <disablevlanhwfilter>1</disablevlanhwfilter>
    <disablechecksumoffloading>1</disablechecksumoffloading>
    <disablesegmentationoffloading>1</disablesegmentationoffloading>
    <disablelargereceiveoffloading>1</disablelargereceiveoffloading>
    <powerd_ac_mode>hadp</powerd_ac_mode>
    <powerd_battery_mode>hadp</powerd_battery_mode>
    <powerd_normal_mode>hadp</powerd_normal_mode>
    <bogons>
      <interval>monthly</interval>
    </bogons>
    <crypto_hardware>aesni</crypto_hardware>
    <pf_share_forward>1</pf_share_forward>
    <lb_use_sticky>1</lb_use_sticky>
    <ssh>
      <group>admins</group>
      <noauto>1</noauto>
      <interfaces/>
      <kex/>
      <ciphers/>
      <macs/>
      <keys/>
    </ssh>
    <backup>
      <nextcloud version="1.0.0">
        <enabled>0</enabled>
        <url/>
        <user/>
        <password/>
        <password_encryption/>
        <backupdir>OPNsense-Backup</backupdir>
      </nextcloud>
    </backup>
    <language>en_US</language>
    <dnsserver>8.8.8.8</dnsserver>
    <dnsserver>1.1.1.1</dnsserver>
    <firmware version="1.0.0">
      <mirror>https://mirror-opnsense.serverbase.ch</mirror>
      <plugins>os-redis,os-ntopng</plugins>
    </firmware>
    <use_mfs_var>1</use_mfs_var>
    <use_mfs_tmp>1</use_mfs_tmp>
    <use_swap_file>2048</use_swap_file>
    <disablebeep>1</disablebeep>
    <serialspeed>115200</serialspeed>
    <primaryconsole>video</primaryconsole>
    <dnsallowoverride_exclude/>
    <dns1gw>none</dns1gw>
    <dns2gw>none</dns2gw>
    <dns3gw>none</dns3gw>
    <dns4gw>none</dns4gw>
    <dns5gw>none</dns5gw>
    <dns6gw>none</dns6gw>
    <dns7gw>none</dns7gw>
    <dns8gw>none</dns8gw>
    <rulesetoptimization>basic</rulesetoptimization>
    <maximumstates/>
    <maximumfrags/>
    <aliasesresolveinterval/>
    <maximumtableentries/>
  </system>
  <interfaces>
    <wan>
      <if>vtnet0</if>
      <descr/>
      <enable>1</enable>
      <lock>1</lock>
      <spoofmac/>
      <blockpriv>1</blockpriv>
      <blockbogons>1</blockbogons>
      <ipaddr>dhcp</ipaddr>
      <dhcphostname/>
      <alias-address/>
      <alias-subnet>32</alias-subnet>
      <dhcprejectfrom/>
      <adv_dhcp_pt_timeout/>
      <adv_dhcp_pt_retry/>
      <adv_dhcp_pt_select_timeout/>
      <adv_dhcp_pt_reboot/>
      <adv_dhcp_pt_backoff_cutoff/>
      <adv_dhcp_pt_initial_interval/>
      <adv_dhcp_pt_values>SavedCfg</adv_dhcp_pt_values>
      <adv_dhcp_send_options/>
      <adv_dhcp_request_options/>
      <adv_dhcp_required_options/>
      <adv_dhcp_option_modifiers/>
      <adv_dhcp_config_advanced/>
      <adv_dhcp_config_file_override/>
      <adv_dhcp_config_file_override_path/>
      <ipaddrv6>dhcp6</ipaddrv6>
      <dhcp6-ia-pd-len>0</dhcp6-ia-pd-len>
      <adv_dhcp6_interface_statement_send_options/>
      <adv_dhcp6_interface_statement_request_options/>
      <adv_dhcp6_interface_statement_information_only_enable/>
      <adv_dhcp6_interface_statement_script/>
      <adv_dhcp6_id_assoc_statement_address_enable/>
      <adv_dhcp6_id_assoc_statement_address/>
      <adv_dhcp6_id_assoc_statement_address_id/>
      <adv_dhcp6_id_assoc_statement_address_pltime/>
      <adv_dhcp6_id_assoc_statement_address_vltime/>
      <adv_dhcp6_id_assoc_statement_prefix_enable/>
      <adv_dhcp6_id_assoc_statement_prefix/>
      <adv_dhcp6_id_assoc_statement_prefix_id/>
      <adv_dhcp6_id_assoc_statement_prefix_pltime/>
      <adv_dhcp6_id_assoc_statement_prefix_vltime/>
      <adv_dhcp6_prefix_interface_statement_sla_len/>
      <adv_dhcp6_authentication_statement_authname/>
      <adv_dhcp6_authentication_statement_protocol/>
      <adv_dhcp6_authentication_statement_algorithm/>
      <adv_dhcp6_authentication_statement_rdm/>
      <adv_dhcp6_key_info_statement_keyname/>
      <adv_dhcp6_key_info_statement_realm/>
      <adv_dhcp6_key_info_statement_keyid/>
      <adv_dhcp6_key_info_statement_secret/>
      <adv_dhcp6_key_info_statement_expire/>
      <adv_dhcp6_config_advanced/>
      <adv_dhcp6_config_file_override/>
      <adv_dhcp6_config_file_override_path/>
    </wan>
    <lan>
      <if>vtnet1</if>
      <descr/>
      <enable>1</enable>
      <lock>1</lock>
      <spoofmac/>
      <ipaddr>10.206.144.1</ipaddr>
      <subnet>24</subnet>
      <ipaddrv6>track6</ipaddrv6>
      <track6-interface>wan</track6-interface>
      <track6-prefix-id>0</track6-prefix-id>
    </lan>
    <lo0>
      <internal_dynamic>1</internal_dynamic>
      <descr>Loopback</descr>
      <enable>1</enable>
      <if>lo0</if>
      <ipaddr>127.0.0.1</ipaddr>
      <ipaddrv6>::1</ipaddrv6>
      <subnet>8</subnet>
      <subnetv6>128</subnetv6>
      <type>none</type>
      <virtual>1</virtual>
    </lo0>
    <openvpn>
      <internal_dynamic>1</internal_dynamic>
      <enable>1</enable>
      <if>openvpn</if>
      <descr>OpenVPN</descr>
      <type>group</type>
      <virtual>1</virtual>
    </openvpn>
  </interfaces>
  <dhcpd>
    <lan>
      <enable>1</enable>
      <gateway>10.206.144.1</gateway>
      <ddnsdomainalgorithm>hmac-md5</ddnsdomainalgorithm>
      <numberoptions>
        <item/>
      </numberoptions>
      <range>
        <from>10.206.144.10</from>
        <to>10.206.144.200</to>
      </range>
      <winsserver/>
      <dnsserver>8.8.8.8</dnsserver>
      <dnsserver>1.1.1.1</dnsserver>
      <ntpserver/>
    </lan>
  </dhcpd>
  <unbound>
    <enable>on</enable>
  </unbound>
  <snmpd>
    <syslocation/>
    <syscontact/>
    <rocommunity>public</rocommunity>
  </snmpd>
  <syslog>
    <reverse/>
  </syslog>
  <nat>
    <outbound>
      <mode>automatic</mode>
    </outbound>
  </nat>
  <filter>
    <rule>
      <type>pass</type>
      <ipprotocol>inet</ipprotocol>
      <descr>Default allow LAN to any rule</descr>
      <interface>lan</interface>
      <source>
        <network>lan</network>
      </source>
      <destination>
        <any/>
      </destination>
    </rule>
    <rule>
      <type>pass</type>
      <ipprotocol>inet6</ipprotocol>
      <descr>Default allow LAN IPv6 to any rule</descr>
      <interface>lan</interface>
      <source>
        <network>lan</network>
      </source>
      <destination>
        <any/>
      </destination>
    </rule>
    <rule>
      <descr>OpenVPN  wizard allow client access</descr>
      <direction>in</direction>
      <source>
        <any>1</any>
      </source>
      <destination>
        <network>(self)</network>
        <port>1194</port>
      </destination>
      <floating>yes</floating>
      <protocol>udp</protocol>
      <ipprotocol>inet46</ipprotocol>
      <type>pass</type>
      <enabled>on</enabled>
      <created>
        <username>mattia@10.206.144.10</username>
        <time>1635431158.7754</time>
        <description>/wizard.php made changes</description>
      </created>
    </rule>
    <rule>
      <descr>OpenVPN  wizard</descr>
      <source>
        <any>1</any>
      </source>
      <destination>
        <any>1</any>
      </destination>
      <interface>openvpn</interface>
      <type>pass</type>
      <enabled>on</enabled>
      <created>
        <username>mattia@10.206.144.10</username>
        <time>1635431158.7755</time>
        <description>/wizard.php made changes</description>
      </created>
    </rule>
  </filter>
  <rrd>
    <enable/>
  </rrd>
  <load_balancer>
    <monitor_type>
      <name>ICMP</name>
      <type>icmp</type>
      <descr>ICMP</descr>
      <options/>
    </monitor_type>
    <monitor_type>
      <name>TCP</name>
      <type>tcp</type>
      <descr>Generic TCP</descr>
      <options/>
    </monitor_type>
    <monitor_type>
      <name>HTTP</name>
      <type>http</type>
      <descr>Generic HTTP</descr>
      <options>
        <path>/</path>
        <host/>
        <code>200</code>
      </options>
    </monitor_type>
    <monitor_type>
      <name>HTTPS</name>
      <type>https</type>
      <descr>Generic HTTPS</descr>
      <options>
        <path>/</path>
        <host/>
        <code>200</code>
      </options>
    </monitor_type>
    <monitor_type>
      <name>SMTP</name>
      <type>send</type>
      <descr>Generic SMTP</descr>
      <options>
        <send/>
        <expect>220 *</expect>
      </options>
    </monitor_type>
  </load_balancer>
  <ntpd>
    <prefer>0.opnsense.pool.ntp.org</prefer>
  </ntpd>
  <widgets>
    <sequence>system_information-container:00000000-col1:show,gateways-container:00000001-col1:show,services_status-container:00000002-col2:show,interface_list-container:00000003-col3:show,interface_statistics-container:00000004-col3:show,traffic_graphs-container:00000005-col4:show,log-container:00000006-col4:show,openvpn-container:00000007-col4:show</sequence>
    <column_count>3</column_count>
    <filterlogentries>5</filterlogentries>
    <filterlogentriesupdateinterval>2</filterlogentriesupdateinterval>
    <filterlogentriesacts>Block Reject</filterlogentriesacts>
    <filterlogentriesinterfaces>vtnet0,vtnet1,lo0,openvpn</filterlogentriesinterfaces>
  </widgets>
  <revision>
    <username>mattia@10.206.144.10</username>
    <time>1635431534.4049</time>
    <description>/firewall_rules.php made changes</description>
  </revision>
  <OPNsense>
    <Firewall>
      <Alias version="1.0.0">
        <geoip>
          <url/>
        </geoip>
        <aliases/>
      </Alias>
      <Category version="1.0.0">
        <categories/>
      </Category>
      <Lvtemplate version="0.0.1">
        <templates/>
      </Lvtemplate>
    </Firewall>
    <captiveportal version="1.0.0">
      <zones/>
      <templates/>
    </captiveportal>
    <Interfaces>
      <vxlans/>
      <loopbacks/>
    </Interfaces>
    <IPsec version="1.0.0">
      <general>
        <enabled/>
      </general>
      <keyPairs/>
    </IPsec>
    <OpenVPNExport version="0.0.1">
      <servers/>
    </OpenVPNExport>
    <proxy version="1.0.5">
      <general>
        <enabled>0</enabled>
        <error_pages>opnsense</error_pages>
        <icpPort/>
        <logging>
          <enable>
            <accessLog>1</accessLog>
            <storeLog>1</storeLog>
          </enable>
          <ignoreLogACL/>
          <target/>
        </logging>
        <alternateDNSservers/>
        <dnsV4First>0</dnsV4First>
        <forwardedForHandling>on</forwardedForHandling>
        <uriWhitespaceHandling>strip</uriWhitespaceHandling>
        <enablePinger>1</enablePinger>
        <useViaHeader>1</useViaHeader>
        <suppressVersion>0</suppressVersion>
        <connecttimeout/>
        <VisibleEmail>admin@localhost.local</VisibleEmail>
        <VisibleHostname/>
        <cache>
          <local>
            <enabled>0</enabled>
            <directory>/var/squid/cache</directory>
            <cache_mem>256</cache_mem>
            <maximum_object_size/>
            <maximum_object_size_in_memory/>
            <memory_cache_mode>always</memory_cache_mode>
            <size>100</size>
            <l1>16</l1>
            <l2>256</l2>
            <cache_linux_packages>0</cache_linux_packages>
            <cache_windows_updates>0</cache_windows_updates>
          </local>
        </cache>
        <traffic>
          <enabled>0</enabled>
          <maxDownloadSize>2048</maxDownloadSize>
          <maxUploadSize>1024</maxUploadSize>
          <OverallBandwidthTrotteling>1024</OverallBandwidthTrotteling>
          <perHostTrotteling>256</perHostTrotteling>
        </traffic>
        <parentproxy>
          <enabled>0</enabled>
          <host/>
          <enableauth>0</enableauth>
          <user>username</user>
          <password>password</password>
          <port/>
          <localdomains/>
          <localips/>
        </parentproxy>
      </general>
      <forward>
        <interfaces>lan</interfaces>
        <port>3128</port>
        <sslbumpport>3129</sslbumpport>
        <sslbump>0</sslbump>
        <sslurlonly>0</sslurlonly>
        <sslcertificate/>
        <sslnobumpsites/>
        <ssl_crtd_storage_max_size>4</ssl_crtd_storage_max_size>
        <sslcrtd_children>5</sslcrtd_children>
        <snmp_enable>0</snmp_enable>
        <snmp_port>3401</snmp_port>
        <snmp_password>public</snmp_password>
        <ftpInterfaces/>
        <ftpPort>2121</ftpPort>
        <ftpTransparentMode>0</ftpTransparentMode>
        <addACLforInterfaceSubnets>1</addACLforInterfaceSubnets>
        <transparentMode>0</transparentMode>
        <acl>
          <allowedSubnets/>
          <unrestricted/>
          <bannedHosts/>
          <whiteList/>
          <blackList/>
          <browser/>
          <mimeType/>
          <googleapps/>
          <youtube/>
          <safePorts>80:http,21:ftp,443:https,70:gopher,210:wais,1025-65535:unregistered ports,280:http-mgmt,488:gss-http,591:filemaker,777:multiling http</safePorts>
          <sslPorts>443:https</sslPorts>
          <remoteACLs>
            <blacklists/>
            <UpdateCron/>
          </remoteACLs>
        </acl>
        <icap>
          <enable>0</enable>
          <RequestURL>icap://[::1]:1344/avscan</RequestURL>
          <ResponseURL>icap://[::1]:1344/avscan</ResponseURL>
          <SendClientIP>1</SendClientIP>
          <SendUsername>0</SendUsername>
          <EncodeUsername>0</EncodeUsername>
          <UsernameHeader>X-Username</UsernameHeader>
          <EnablePreview>1</EnablePreview>
          <PreviewSize>1024</PreviewSize>
          <OptionsTTL>60</OptionsTTL>
          <exclude/>
        </icap>
        <authentication>
          <method/>
          <authEnforceGroup/>
          <realm>OPNsense proxy authentication</realm>
          <credentialsttl>2</credentialsttl>
          <children>5</children>
        </authentication>
      </forward>
      <pac/>
      <error_pages>
        <template/>
      </error_pages>
    </proxy>
    <Syslog version="1.0.0">
      <general>
        <enabled>1</enabled>
      </general>
      <destinations/>
    </Syslog>
    <TrafficShaper version="1.0.3">
      <pipes/>
      <queues/>
      <rules/>
    </TrafficShaper>
    <unboundplus version="1.0.0">
      <service_enabled/>
      <dnsbl>
        <enabled>0</enabled>
        <type/>
        <lists/>
        <whitelists/>
      </dnsbl>
      <dots/>
      <miscellaneous>
        <privatedomain/>
      </miscellaneous>
    </unboundplus>
    <Netflow version="1.0.1">
      <capture>
        <interfaces>lan,wan</interfaces>
        <egress_only>wan</egress_only>
        <version>v9</version>
        <targets>127.0.0.1:2056</targets>
      </capture>
      <collect>
        <enable>1</enable>
      </collect>
      <activeTimeout>1800</activeTimeout>
      <inactiveTimeout>15</inactiveTimeout>
    </Netflow>
    <monit version="1.0.9">
      <general>
        <enabled>0</enabled>
        <interval>120</interval>
        <startdelay>120</startdelay>
        <mailserver>127.0.0.1</mailserver>
        <port>25</port>
        <username/>
        <password/>
        <ssl>0</ssl>
        <sslversion>auto</sslversion>
        <sslverify>0</sslverify>
        <logfile>syslog facility log_daemon</logfile>
        <statefile/>
        <eventqueuePath/>
        <eventqueueSlots/>
        <httpdEnabled>0</httpdEnabled>
        <httpdUsername>root</httpdUsername>
        <httpdPassword>mMe3IPOENcvHAYelfWwxgYrb</httpdPassword>
        <httpdPort>2812</httpdPort>
        <httpdAllow/>
        <mmonitUrl/>
        <mmonitTimeout>5</mmonitTimeout>
        <mmonitRegisterCredentials>1</mmonitRegisterCredentials>
      </general>
      <service uuid="8201cb2e-7ae9-4ccd-ad1a-afe60ee2f530">
        <enabled>1</enabled>
        <name>$HOST</name>
        <description/>
        <type>system</type>
        <pidfile/>
        <match/>
        <path/>
        <timeout>300</timeout>
        <address/>
        <interface/>
        <start/>
        <stop/>
        <tests>57e1f37e-c78e-410c-8f80-649a12550eee,8d1c8b5c-7586-4992-b603-08ba9a1056be,8a012cea-5fa1-4579-892c-4f5298e64d0d,aab6a5d7-d11c-4e9c-bea0-1d156c91ad2f</tests>
        <depends/>
      </service>
      <service uuid="06a4e058-7eeb-45a9-9691-58ea448da79e">
        <enabled>1</enabled>
        <name>RootFs</name>
        <description/>
        <type>filesystem</type>
        <pidfile/>
        <match/>
        <path>/</path>
        <timeout>300</timeout>
        <address/>
        <interface/>
        <start/>
        <stop/>
        <tests>cacc1463-790b-47e2-8b8f-52f48b21b863</tests>
        <depends/>
      </service>
      <service uuid="a2db5254-1fc8-4656-b6ee-1241dc83c1be">
        <enabled>0</enabled>
        <name>carp_status_change</name>
        <description/>
        <type>custom</type>
        <pidfile/>
        <match/>
        <path>/usr/local/opnsense/scripts/OPNsense/Monit/carp_status</path>
        <timeout>300</timeout>
        <address/>
        <interface/>
        <start/>
        <stop/>
        <tests>3a16452e-0805-4c62-86b2-9abfd2e462b5</tests>
        <depends/>
      </service>
      <service uuid="32157f99-9974-4a1f-a022-583948334fa7">
        <enabled>0</enabled>
        <name>gateway_alert</name>
        <description/>
        <type>custom</type>
        <pidfile/>
        <match/>
        <path>/usr/local/opnsense/scripts/OPNsense/Monit/gateway_alert</path>
        <timeout>300</timeout>
        <address/>
        <interface/>
        <start/>
        <stop/>
        <tests>679e1ca8-4666-4159-9fe4-9f18b722443f</tests>
        <depends/>
      </service>
      <test uuid="c8a34bbc-b008-432f-974c-d036f55d54fe">
        <name>Ping</name>
        <type>NetworkPing</type>
        <condition>failed ping</condition>
        <action>alert</action>
        <path/>
      </test>
      <test uuid="aaae75f4-31e9-4c62-9a22-c8cc687c90e4">
        <name>NetworkLink</name>
        <type>NetworkInterface</type>
        <condition>failed link</condition>
        <action>alert</action>
        <path/>
      </test>
      <test uuid="04518ded-5df9-4fc5-8d4b-f0e9eaab8567">
        <name>NetworkSaturation</name>
        <type>NetworkInterface</type>
        <condition>saturation is greater than 75%</condition>
        <action>alert</action>
        <path/>
      </test>
      <test uuid="57e1f37e-c78e-410c-8f80-649a12550eee">
        <name>MemoryUsage</name>
        <type>SystemResource</type>
        <condition>memory usage is greater than 75%</condition>
        <action>alert</action>
        <path/>
      </test>
      <test uuid="8d1c8b5c-7586-4992-b603-08ba9a1056be">
        <name>CPUUsage</name>
        <type>SystemResource</type>
        <condition>cpu usage is greater than 75%</condition>
        <action>alert</action>
        <path/>
      </test>
      <test uuid="8a012cea-5fa1-4579-892c-4f5298e64d0d">
        <name>LoadAvg1</name>
        <type>SystemResource</type>
        <condition>loadavg (1min) is greater than 4</condition>
        <action>alert</action>
        <path/>
      </test>
      <test uuid="aab6a5d7-d11c-4e9c-bea0-1d156c91ad2f">
        <name>LoadAvg5</name>
        <type>SystemResource</type>
        <condition>loadavg (5min) is greater than 3</condition>
        <action>alert</action>
        <path/>
      </test>
      <test uuid="f3392204-ad30-4e4b-956b-6e906c84a6fe">
        <name>LoadAvg15</name>
        <type>SystemResource</type>
        <condition>loadavg (15min) is greater than 2</condition>
        <action>alert</action>
        <path/>
      </test>
      <test uuid="cacc1463-790b-47e2-8b8f-52f48b21b863">
        <name>SpaceUsage</name>
        <type>SpaceUsage</type>
        <condition>space usage is greater than 75%</condition>
        <action>alert</action>
        <path/>
      </test>
      <test uuid="3a16452e-0805-4c62-86b2-9abfd2e462b5">
        <name>ChangedStatus</name>
        <type>ProgramStatus</type>
        <condition>changed status</condition>
        <action>alert</action>
        <path/>
      </test>
      <test uuid="679e1ca8-4666-4159-9fe4-9f18b722443f">
        <name>NonZeroStatus</name>
        <type>ProgramStatus</type>
        <condition>status != 0</condition>
        <action>alert</action>
        <path/>
      </test>
    </monit>
    <cron version="1.0.2">
      <jobs>
        <job uuid="8dcb2f85-4668-489d-b22c-b3c48c900e65">
          <origin>IDS</origin>
          <enabled>0</enabled>
          <minutes>0</minutes>
          <hours>0</hours>
          <days>*</days>
          <months>*</months>
          <weekdays>*</weekdays>
          <who>root</who>
          <command>ids update</command>
          <parameters/>
          <description>ids rule updates</description>
        </job>
      </jobs>
    </cron>
    <IDS version="1.0.6">
      <rules/>
      <policies/>
      <userDefinedRules/>
      <files>
        <file uuid="e2429227-fff4-48d9-b761-60511aeb39d4">
          <filename>abuse.ch.sslipblacklist.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="fc77cf50-0427-4048-8eb4-9ea21e854f57">
          <filename>abuse.ch.sslblacklist.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="ea5aeb12-076c-44d5-9146-8da825396f51">
          <filename>abuse.ch.urlhaus.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="3c5b0b80-bcc0-43ba-b259-5f1a2d1bc0e2">
          <filename>abuse.ch.threatfox.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="364d713d-7fe0-466c-b078-f39cbc6fd99d">
          <filename>opnsense.uncategorized.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="3ddf1418-d80d-4fdc-96f4-709e840dafbb">
          <filename>opnsense.test.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="328c8f62-f637-4de9-bb27-29b9991b0fc6">
          <filename>opnsense.social_media.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="8eb7630c-acc6-46b3-b23c-bcaec27a6630">
          <filename>opnsense.messaging.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="b16dca68-0f99-421c-a3ed-0105a48f29c5">
          <filename>opnsense.media_streaming.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="b7912f02-ef47-4e49-a9bf-1b3b939c208d">
          <filename>opnsense.mail.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="c8c95124-45ff-4640-8a65-a94e4e21a880">
          <filename>opnsense.file_transfer.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="37746a35-f238-4155-b1bc-b9fda2faac16">
          <filename>tor.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="e50d0932-2e9f-4982-9e01-8d202ad842ef">
          <filename>emerging-worm.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="9071abb0-e75f-46aa-8fad-72dd831bbd33">
          <filename>emerging-web_specific_apps.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="6217bc52-a0fe-403c-9d0e-2ada8f179754">
          <filename>emerging-web_server.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="f0bf714a-26b7-4150-8d85-39ea52762560">
          <filename>emerging-web_client.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="753f3fd0-17dd-4cab-b150-8d4a7edf0b56">
          <filename>emerging-voip.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="f65ede76-4895-4c7e-aa58-11ece97ae18d">
          <filename>emerging-user_agents.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="9b73a07b-09f2-44c5-8d08-802e6b6854b2">
          <filename>emerging-trojan.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="ff1df82d-2520-4963-9dae-163a5399a262">
          <filename>emerging-tftp.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="ead796cc-3ed6-4151-b37f-6db1db76b3d0">
          <filename>emerging-telnet.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="6399b2a3-2db0-40c3-a7be-b9b221a85458">
          <filename>emerging-sql.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="01c1e872-a3e6-4c29-997e-351a1164b129">
          <filename>emerging-snmp.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="0da94fc2-394c-4484-ac5e-50bd6fa5e05f">
          <filename>emerging-smtp.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="ea814221-3d7e-4aa2-b693-e138e45167c2">
          <filename>emerging-shellcode.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="0c58bc7f-b5ed-49c3-aabc-89dd6b801797">
          <filename>emerging-scan.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="547bd700-0c1b-4213-a90e-5c0d8e196961">
          <filename>emerging-scada.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="60fcd6e7-a552-4134-b315-99f249518ef4">
          <filename>emerging-rpc.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="470ff87f-a2bc-4911-ae7b-ac264f50b332">
          <filename>emerging-pop3.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="5821a398-d336-4317-a00e-8d9912fc0f58">
          <filename>emerging-policy.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="1e7bae5f-2bea-48c5-8bb4-493a959a88ec">
          <filename>emerging-p2p.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="94dd87d6-8f90-41b0-a024-6158e1e77c09">
          <filename>emerging-netbios.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="3e67aadc-15b7-46df-8e74-9098a1a98062">
          <filename>emerging-mobile_malware.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="77660d9d-2e03-4a3e-8f41-aec594b0c8bd">
          <filename>emerging-misc.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="05edc92b-842f-4a74-9b82-111610a48f4a">
          <filename>emerging-malware.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="45ba8785-368b-4fab-a9a9-3c747fca0185">
          <filename>emerging-info.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="27e3da7c-6ed6-4b6d-8f61-33e9c91c9862">
          <filename>emerging-inappropriate.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="a8d666db-873e-4dd8-886b-122e8a7190e3">
          <filename>emerging-imap.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="044f3325-9dc2-465b-8ab5-a499ff938151">
          <filename>emerging-icmp_info.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="8714c080-431e-45ce-ac77-1717ed040552">
          <filename>emerging-icmp.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="30975492-52eb-4584-8d83-09e9ac833cb7">
          <filename>emerging-games.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="b70561ca-d135-4cc3-9835-95c9cc46b9f5">
          <filename>emerging-ftp.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="062db405-4e95-4bbe-8c8d-953854e073cc">
          <filename>emerging-exploit.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="ded425fe-cb2c-4d84-998e-47156f5ec8a2">
          <filename>emerging-dos.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="9f1542c1-3b35-4400-832e-240e969174ef">
          <filename>emerging-dns.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="4ced0fb5-c856-4ccc-8318-34ee926948c9">
          <filename>emerging-deleted.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="fa3c5abe-89dd-4ba4-9965-dffdc4858b8b">
          <filename>emerging-current_events.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="d5836f90-eb8b-48a4-8068-05ea338a778a">
          <filename>emerging-chat.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="f5523e56-cfd9-4eaa-b60f-bd4633026696">
          <filename>emerging-attack_response.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="4f6426b4-5355-48ab-b8f8-5d0375a66570">
          <filename>emerging-activex.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="cca5e5cb-1846-49d9-939f-5a9eef7f14df">
          <filename>dshield.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="54a75a1b-e699-4120-b72f-0a1b5109e97d">
          <filename>drop.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="b3dfb44c-704b-47d1-9ee4-7042c2a658c9">
          <filename>compromised.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="4721c76e-871e-4b72-9de7-d1f1040ce395">
          <filename>ciarmy.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="5daafb7d-ea51-4d92-9834-ee83a6da5e29">
          <filename>botcc.portgrouped.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="e7eb31e3-5339-4ae9-87c4-35c16f7b7237">
          <filename>botcc.rules</filename>
          <enabled>1</enabled>
        </file>
        <file uuid="be50e9d7-8eca-420d-a53f-2739a928ee1e">
          <filename>abuse.ch.feodotracker.rules</filename>
          <enabled>1</enabled>
        </file>
      </files>
      <fileTags/>
      <general>
        <enabled>1</enabled>
        <ips>0</ips>
        <promisc>0</promisc>
        <interfaces>wan</interfaces>
        <homenet>192.168.0.0/16,10.0.0.0/8,172.16.0.0/12</homenet>
        <defaultPacketSize/>
        <UpdateCron>8dcb2f85-4668-489d-b22c-b3c48c900e65</UpdateCron>
        <AlertLogrotate>W0D23</AlertLogrotate>
        <AlertSaveLogs>4</AlertSaveLogs>
        <MPMAlgo>ac</MPMAlgo>
        <detect>
          <Profile>medium</Profile>
          <toclient_groups/>
          <toserver_groups/>
        </detect>
        <syslog>0</syslog>
        <syslog_eve>0</syslog_eve>
        <LogPayload>0</LogPayload>
      </general>
    </IDS>
    <ntopng>
      <general version="0.0.1">
        <enabled>1</enabled>
        <interface/>
        <httpport>3000</httpport>
        <httpsport>3443</httpsport>
        <cert>60c8b5cdf128a</cert>
        <dnsmode/>
      </general>
    </ntopng>
    <redis version="0.0.0">
      <general>
        <enabled>1</enabled>
        <listen/>
        <protected_mode>1</protected_mode>
        <port>6379</port>
        <log_level>warning</log_level>
        <syslog_enabled>0</syslog_enabled>
        <syslog_facility>LOCAL0</syslog_facility>
        <databases>16</databases>
      </general>
      <security>
        <password/>
        <disable_commands/>
      </security>
      <limits>
        <maxclients>10000</maxclients>
        <maxmemory/>
        <maxmemory_policy>noeviction</maxmemory_policy>
        <maxmemory_samples>5</maxmemory_samples>
      </limits>
      <slowlog>
        <slower_than>10000</slower_than>
        <max_len>128</max_len>
      </slowlog>
    </redis>
  </OPNsense>
  <ca/>
  <gateways>
    <gateway_item/>
  </gateways>
  <cert/>
  <ppps>
    <ppp/>
  </ppps>
  <crl/>
  <staticroutes/>
  <openvpn>
    <openvpn-server>
      <vpnid>1</vpnid>
      <authmode>Local Database</authmode>
      <mode>server_tls_user</mode>
      <caref>60c8b53d706d2</caref>
      <certref>617ab2f6b1d8d</certref>
      <protocol>UDP</protocol>
      <interface>any</interface>
      <local_port>1194</local_port>
      <description/>
      <tls>IwojIDIwNDggYml0IE9wZW5WUE4gc3RhdGljIGtleQojCi0tLS0tQkVHSU4gT3BlblZQTiBTdGF0aWMga2V5IFYxLS0tLS0KM2MwYzYwYmQ2YzQyYTViM2Y0ZTkxYzdkYjgzYTgyMTcKZjMzYmFlN2YwMDdmMGQwMGFmNWY0MWUzMThhZDViMmQKYzg2YjE3ZDAwZjgyZTliNDhhYjJmNDk5YmEzZTBjMDIKYjg1YjE0YTk3MTMzN2U1MzBlYmI2MTYzODcyYTU4ODYKNTlhZWI3NTU0MTU3YzczMWM5ODBlZmZkYmM5NDE3MDQKZjVhNzEzZGViY2Q3N2RkMjA3N2Y5NzQ0YTg4ZmQ2MmEKMjIxNDY4ZGIwMjI4ZjIyZjM4ZjI2OTBiY2ZhNGI3NTEKYzQ2YzZiNmY1ZGFjYTBiZDNiZjk1NTFhZDM2OWI5ODMKYjFhZjk3OTkxNzY2NTQ3YjAwNmZiNTQ1NjI4M2I1ZTIKZTZhYzJiMDc4YjI4NDRhOTdjYmFlZTdkOTRjMzRlMGUKNjliNjBmYTdiMGQzNDM3NDAyYzk0NTcyNTI5MGE3YmUKNjg2OTcyNjU2NmVjMjRiNDIwMjU5NjJmMDUzNzg2OGUKN2JhZmI0MWU2ZTg3YzExZjE2NWE5ZmNiZTA0ZTM5NjIKYTVmODdjMmY3MjY5NWVmYWEzYWE3YTgxMTlmNjdiNWMKZmM3YjI4ZDAzY2MwMDM3NzdjNTUxZDM4NTljYTdjNWYKNjQwMzgxZmYyM2FjODk1NDQ2MWFiOGYyODA0ZmI4NjkKLS0tLS1FTkQgT3BlblZQTiBTdGF0aWMga2V5IFYxLS0tLS0K</tls>
      <tlsmode>auth</tlsmode>
      <dh_length>2048</dh_length>
      <tunnel_network>10.206.16.0/24</tunnel_network>
      <local_network>10.206.144.0/24</local_network>
      <dynamic_ip>on</dynamic_ip>
      <pool_enable>on</pool_enable>
      <crypto>AES-128-CBC</crypto>
      <digest>SHA1</digest>
    </openvpn-server>
  </openvpn>
</opnsense>
